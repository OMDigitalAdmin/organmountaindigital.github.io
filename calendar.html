<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Calendar | Organ Mountain Digital</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="/assets/style.css">
  <link href="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.8/index.global.min.css" rel="stylesheet"/>
  <style>
    .calendar-layout {
      display: grid;
      grid-template-areas:
        "filter filter"
        "calendar sidebar"
        "cta sidebar";
      grid-template-columns: 2fr 1fr;
      gap: 1rem;
      margin: 2rem 0;
    }
    #calendar { grid-area: calendar; }
    .filter { grid-area: filter; }
    .sidebar { grid-area: sidebar; background: #fff; padding: 1rem; border-radius: 8px; }
    .cta { grid-area: cta; text-align: center; }
  </style>
</head>
<body>

  <!-- Header -->
  <header style="position: relative; height: 320px; overflow: hidden;">
    <img src="/assets/images/head-banner.png" alt="Organ Mountains Banner"
         style="position: absolute; width: 100%; height: 100%; object-fit: cover; filter: brightness(0.6); z-index: 0;">
    <div style="position: relative; z-index: 2; color: white; text-align: center; padding-top: 2rem;">
      <h1 class="hero-text">Organ Mountain Digital</h1>
      <p class="hero-text" style="font-size: 1.2rem;">Las Cruces Events & Local Stories</p>
      <nav>
        <ul class="hero-nav">
          <li><a href="/index.html">Home</a></li>
          <li><a href="/about.html">About</a></li>
          <li><a href="/events.html">Events</a></li>
          <li><a href="/calendar.html">Community Calendar</a></li>
          <li><a href="/support.html">Support</a></li>
          <li><a href="/impact.html">Impact</a></li>
        </ul>
      </nav>
    </div>
  </header>

  <main class="calendar-layout">

    <!-- A: Filter -->
    <div class="filter">
      <label for="categoryFilter"><strong>Filter by Category:</strong></label>
      <select id="categoryFilter">
        <option value="all">Show All</option>
        <option value="Family Friendly">Family Friendly</option>
        <option value="Veteran-Owned">Veteran-Owned</option>
        <option value="LGBTQ+ Friendly">LGBTQ+ Friendly</option>
        <!-- Add more later -->
      </select>
    </div>

    <!-- B: Calendar -->
    <div id="calendar"></div>

    <!-- C: Sidebar -->
    <div class="sidebar">
      <h3>Upcoming Events</h3>
      <ul id="upcomingEvents">
        <!-- JS will populate this from events.json -->
      </ul>
    </div>

    <!-- D: Call to Action -->
    <div class="cta">
      <a href="/submit-event.html" class="donation-button">Submit Your Event</a>
    </div>

  </main>

  <script src="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.8/index.global.min.js"></script>
  <script>
    let allEvents = [];

    fetch('events.json')
      .then(res => res.json())
      .then(data => {
        allEvents = data;
        initCalendar(allEvents);
        renderUpcoming(data);
      });

    function initCalendar(events) {
      const calendar = new FullCalendar.Calendar(document.getElementById('calendar'), {
        initialView: 'dayGridMonth',
        events: events,
      });
      calendar.render();

      document.getElementById('categoryFilter').addEventListener('change', function () {
        const value = this.value;
        const filtered = value === 'all' ? allEvents : allEvents.filter(e => e.category === value);
        calendar.removeAllEvents();
        calendar.addEventSource(filtered);
      });
    }

    function renderUpcoming(events) {
      const upcoming = events
        .filter(e => new Date(e.start) >= new Date())
        .slice(0, 5);
      const list = document.getElementById('upcomingEvents');
      list.innerHTML = upcoming.map(ev => `<li><strong>${ev.title}</strong><br>${new Date(ev.start).toLocaleString()}</li>`).join('');
    }
  </script>

  <footer>
    <p>&copy; 2025 Organ Mountain Digital, LLC. All rights reserved.</p>
  </footer>

</body>
</html>
